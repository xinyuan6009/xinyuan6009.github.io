# anySDK登陆校验模块

##登陆许可校验 accessCheck(int appId,int channelId) （需要与SDK相关负责人进行协议沟通 1天）
根据anysdk传上来的appid、channelid进行判断，返回是否允许登录标示。
Appid的校验有两点：1，此appid存在。2，此appid没有在登录黑名单中。ChannelId的判断是以白名单的形式进行的，如果上传的channelId没有在白名单中，则返回不让登录。
	Appid黑名单和白名单存储在sdk server的db中。使用方式为redis<->mysql。而具体的操作逻辑实现在manager管理后台中。这样有助于性能的提高。

##生成百度ID和AccessToken accessGrant(int sdkId,int channelId) （1天）
根据上传的anySDK+渠道uid生成唯一对应的anysdk-baidu uid
，并为每次登录生成accessToken，用于下发给cp进行二次校验。
![](media/14776383256894/14776398253110.jpg)
自动登陆是什么呢？
Token过期 时间怎么定？

##CP二次校验  tokenCheck(String uid,String token); （1天）
校验用户和Token是否有效
对token进行解密
对Uid进行校验 判断账号是否合法

##问题：
1·后端对接我找金房，前端对接我要找谁呢
2·自动登录是什么逻辑 这块交代的比较少
3·方法二中的anySDK是什么 由谁提供 是一个ID么


#SDK支付板块
##通过SDK订单生产百度订单  createBaiduOrder(SDKOrder sdkOrder)(1-1.5天 需要跟SDK和后端系统进行业务和交互协议沟通);
接受并	解析SDK对象 根据实际去求获取缺失数据，整合并入库
1·通过SDK_ORDER 创建百度订单 中间需要数据整合
2·将百度订单入库
##SDK完成支付订单次校验 orderCheck(0.5天);
对SDK订单进行校验，校验订单是否合法
1·校验订单信息
2·将校验结果回调给SDK
3·将校验结果入库
##订单校验通过 发起二次校验（1天 涉及到与SDK对接 对接耗时）
想SDK查单 我调用SDK接口
告知SDK订单校验结果，让SDK方面对订单进行二次校验

##异步回调支付系统  orderPush()(1天)
将校验信息异步推送给支付系统
根据校验结果，将SDK订单信息通过RocketMq客户端推送到消息队列
供支付系统调试


##问题
![](media/14776383256894/14776417315650.jpg)

1·支付流程有点儿忘了 希望能再简单说一下
2·前端后端对接人都是谁？



排期规划
2016-11-1（下周一） 设计文档&项目实施文档(1天)
2016-11-2 正式开始 主要做两个项目搭建 环境配置(比如项目依赖的各种技术环境搭建) 项目前期铺垫工作 (1天)
2016-11-3 【登陆模块】登陆许可校验 accessCheck 的开发和自测(1天)
2016-11-4 【登陆模块】生成百度ID和AccessToken accessGrant 的开发和自测(1天)
2016-11-5 【登陆模块】CP二次校验  tokenCheck的开发和自测(1天)

SDK支付板块
2016-11-6/7 【支付模块】通过SDK订单生产百度订单  createBaiduOrder (设计到跟SDK交涉具体订单协议 所以预估了1.5天)
2016-11-7 【支付模块】SDK完成支付订单次校验 orderCheck(0.5天)
2016-11-8 【支付模块】订单校验通过 发起二次校验(1天)
2016-11-9 【支付模块】异步回调支付系统（再讨论）(0.5天)

预计开发周期 7-8天 buffer时间1-2天

